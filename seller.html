<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  
  <meta charset="UTF-8" />
  <title>Seller Dashboard</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      
    }
    
    h1, h2 {
      color: black;
    }
    form, ul, div {
      margin-bottom: 30px;
    }
    input, textarea, button {
      padding: 8px;
      margin-bottom: 10px;
    }
    .order-card {
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 15px;
      background: #f9f9f9;
    }
  .product-grid {
      display: grid;
       grid-template-columns: repeat(5, 1fr);
      gap: 20px;
    }

.product-card {
  background: #f5f3ff;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  display: flex;
  flex-direction: column;
  font-size: 14px;
  width: auto;
  height: auto;
  cursor: pointer;
}

.product-card img {
  height: 250px;
  width: 100%;
  object-fit: cover;
}

.product-info {
  padding: 6px 10px;
  display: flex;
  flex-direction: column;
}

.product-title {
  font-weight: bold;
  color: #333;
  margin: 0 0 4px 0;
}

.product-price {
  font-weight: bold;
  color: #000;
   margin: 0 0 8px 0;
}



.remove-btn {
  margin: 0;
  padding: 6px 10px;
  background-color: red;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 13px;
}


        /* Modal styles */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 300px;
      text-align: center;
      position: relative;
    }
    #modalTitle {
  font-size: 18px;
  font-weight: bold;
  margin-top: 10px;
}

#modalPrice {
  font-weight: bold;
  margin: 5px 0;
}
    .modal-content img {
      max-width: 100%;
      max-height: 200px;
      object-fit: contain;
      border-radius: 8px;
      border-radius: 10px;
    }

    .modal .close {
      position: absolute;
      right: 10px;
      top: 10px;
      font-size: 24px;
      cursor: pointer;
    }

    .modal-content button {
      padding: 10px 15px;
      border: none;
      background-color: #0d6efd;
      color: white;
      border-radius: 5px;
      margin: 10px 5px 0 5px;
      cursor: pointer;
    }

    .modal-content button:hover {
      opacity: 0.9;
    }

    #modalDescription {
      font-size: 14px;
      color: #444;
      margin: 10px 0;
    }

.form-card {
  background: #f5f3ff;
  padding: 20px;
  border-radius: 10px;
  max-width: 400px;     /* smaller width */
  margin: 20px auto;    /* center and add vertical spacing */
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
}


.form-card h2 {
  text-align: center;
  margin-bottom: 15px;
  color: #0d6efd;
  font-size: 20px; /* reduced from default */
}


.form-column {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.form-column input,
.form-column textarea {
  padding: 10px;
  font-size: 15px;
  border: 1px solid #ccc;
  border-radius: 6px;
  width: 100%;
  box-sizing: border-box;
}

.form-column textarea {
  resize: vertical;
  height: 100px;
}

.form-column button {
  background-color: #0d6efd;
  color: white;
  padding: 12px;
  border: none;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
  transition: 0.3s ease;
}

.form-column button:hover {
  background-color: #084298;
}

.load-orders-btn {
  background-color: #0d6efd; /* Bootstrap Blue */
  color: white;
  padding: 10px 15px;
  border: none;
  font-size: 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.load-orders-btn:hover {
  background-color: #084298; /* Darker Blue on hover */
}

/* =============== 1280px and below =============== */
@media (max-width: 1280px) {
  body {
    overflow-x: hidden;
  }

  .product-grid {
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: clamp(14px, 3vw, 24px);
  }

  .product-card img {
    height: 240px;
  }

  .banner-slider {
    width: 100vw;
    max-width: 100vw;
    height: 420px;
    overflow: hidden;
  }

  .banner-image {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 1s ease-in-out;
  }

  .banner-image.active {
    opacity: 1;
    z-index: 1;
  }
}


/* =============== 768px and below =============== */
@media (max-width: 768px) {
  .product-grid {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: clamp(10px, 4vw, 16px);
  }

  .product-card img {
    height: 200px;
  }

  .banner-slider {
    height: 300px;
  }
}


/* =============== 400px and below =============== */
@media (max-width: 400px) {


 .product-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: clamp(5px, 5vw, 10px);
  }

  .product-card img {
    height: 180px;
  }

  .product-card {
    font-size: 13px;
    
  }


  </style>
</head>
<body>
 <div class="form-card">
  <h2>Add New Product</h2>
  <form id="addProductForm" class="form-column">
    <input type="text" id="productName" placeholder="Product Name" required />
    <input type="number" id="productPrice" placeholder="Price" required />
    <input type="text" id="productImage" placeholder="Image URL" />
    <textarea id="productDescription" placeholder="Description" required></textarea>
    <button type="submit">Add Product</button>
  </form>
</div>



  <h2>Your Products</h2>
  <div id="productList" class="product-grid"></div>

  <h2>My Orders (Product Sales)</h2>
  <button class="load-orders-btn" onclick="fetchMyOrders()">Load My Orders</button>
  <div id="myOrders"></div>

  <div class="modal" id="productModal">
<div class="modal-content">
  <span class="close" onclick="closeModal()">&times;</span>
  <img id="modalImage" src="" alt="Product Image" />
  <div id="modalTitle"></div>
  <div id="modalPrice"></div>
  <div id="modalDescription"></div>
</div>
</div>


  <script>
    const token = localStorage.getItem('token');
    if (!token) {
      alert('Please login first');
      window.location.href = 'login.html';
    }

    const addProductForm = document.getElementById('addProductForm');
    const productList = document.getElementById('productList');

    async function fetchSellerProducts() {
      const res = await fetch('http://internintelligencee-commerce-website-production.up.railway.app/my-products', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token }),
      });
      const products = await res.json();

      productList.innerHTML = '';
      if (products.length === 0) {
        productList.innerHTML = '<li>No products yet.</li>';
        return;
      }

      products.forEach(p => {
        const card = document.createElement('div');
card.className = 'product-card';
card.innerHTML = `
  ${p.image ? `<img src="${p.image}" alt="Product Image">` : ''}
  <div class="product-info">
    <div class="product-title" title="${p.name}">${p.name}</div>
    <div class="product-price">Rs ${p.price}</div>
    <button class="remove-btn" onclick="removeProduct('${p._id}', event)">Remove</button>
  </div>
`;


card.onclick = (e) => {
  if (!e.target.classList.contains('remove-btn')) {
    openModal(p);
  }
};

productList.appendChild(card);
});
    }
function openModal(product) {
  document.getElementById('modalImage').src = product.image || '';
  document.getElementById('modalTitle').textContent = product.name;
  document.getElementById('modalPrice').textContent = 'Rs ' + product.price;
  document.getElementById('modalDescription').textContent = product.description;
  document.getElementById('productModal').style.display = 'flex';
}

function closeModal() {
  document.getElementById('productModal').style.display = 'none';
}



    async function fetchMyOrders() {
      const response = await fetch('http://internintelligencee-commerce-website-production.up.railway.app/my-orders', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ token })
      });

      const data = await response.json();

      const ordersDiv = document.getElementById('myOrders');
      ordersDiv.innerHTML = '';

      if (data.length === 0) {
        ordersDiv.innerHTML = '<p>No orders found.</p>';
        return;
      }

      data.forEach(order => {
        const orderEl = document.createElement('div');
        orderEl.className = 'order-card';
        orderEl.innerHTML = `
          <p><strong>Product:</strong> ${order.productName}</p>
          <p><strong>Price:</strong> Rs ${order.productPrice}</p>
          <p><strong>Customer:</strong> ${order.customerEmail}</p>
          <p><strong>Purchased At:</strong> ${new Date(order.purchasedAt).toLocaleString()}</p>
        `;
        ordersDiv.appendChild(orderEl);
      });
    }

    addProductForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('productName').value.trim();
      const description = document.getElementById('productDescription').value.trim();   
      const price = parseFloat(document.getElementById('productPrice').value);
      const image = document.getElementById('productImage').value.trim();

      const res = await fetch('http://internintelligencee-commerce-website-production.up.railway.app/add-product', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token, name, description, price, image }),
      });
      const data = await res.json();
      alert(data.message);
      addProductForm.reset();
      fetchSellerProducts();
    });

    fetchSellerProducts();
    

  function closeModal() {
    document.getElementById('productModal').style.display = 'none';
  }

  async function removeProduct(productId, event) {
    event.stopPropagation(); // prevent modal from opening
    const confirmDelete = confirm("Are you sure you want to remove this product?");
    if (!confirmDelete) return;

    const res = await fetch('http://internintelligencee-commerce-website-production.up.railway.app/delete-product', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ token, productId })
    });

    const data = await res.json();
    alert(data.message);
    fetchSellerProducts(); // reload products
  }

  </script>
</body>
</html>
